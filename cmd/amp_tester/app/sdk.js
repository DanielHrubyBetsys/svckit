window.minus5=window.minus5||{},window.minus5.api=function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=3)}([function(e,n){var t={publish:0,subscribe:1,request:2,response:3,ping:4,pong:5,alive:6},o={diff:0,full:1,append:2,update:3,close:4},r={t:"type",i:"correlationID",e:"error",u:"uri",s:"ts",p:"updateType",b:"subscriptions"},i={s:"source",m:"message",c:"code"};function s(e,n,t){for(var o in t){var r=t[o];void 0!==e[o]&&(n[r]=e[o])}}function u(e){var n,u,a=e.split("\n"),c=null;try{n=JSON.parse(a[0]),u={type:t.publish},s(n,u,r),u.error&&(u.error={},s(n.e,u.error,i)),u.type==t.publish&&void 0===u.updateType&&(u.updateType=o.diff),c=u}catch(e){return null}if(a.length>1&&a[1])try{var l=JSON.parse(a[1]);c.body=l}catch(e){}return c}e.exports={messageType:t,updateType:o,unpack:function(e){if(!e)return null;for(var n=e.split("\n\n"),t=[],o=0;o<n.length;o++){var r=u(n[o]);t[o]=r}return t},unpackMsg:u,pack:function(e){var n={},t=e.body;for(var o in r){var i=r[o];void 0!==e[i]&&(n[o]=e[i])}var s=JSON.stringify(n);return t&&(s+="\n",s+=JSON.stringify(t)),s},ping:function(e){return{type:t.ping,ts:e||(new Date).getTime()}},pong:function(){return{type:t.pong}}}},function(e,n){var t={application:0,transport:1};function o(e,n){return{message:n,isTransport:e==t.transport,isApplication:e==t.application}}e.exports={pooling:function(e,n){var r="code: "+e+", "+n;return o(t.transport,r)},ws:function(e){return o(t.transport,e)},server:function(e){var n=e?e.error:{};return o(n.source||t.application,n.message)}}},function(e,n,t){(function(e){var t=["responseType","withCredentials","timeout","onprogress"];function o(e,n,t){e[n]=e[n]||t}n.ajax=function(n,r){var i=n.headers||{},s=n.body,u=n.method||(s?"POST":"GET"),a=!1,c=function(n){if(n&&e.XDomainRequest&&!/MSIE 1/.test(navigator.userAgent))return new XDomainRequest;if(e.XMLHttpRequest)return new XMLHttpRequest}(n.cors);function l(e,n){return function(){a||(r(void 0===c.status?e:c.status,0===c.status?"Error":c.response||c.responseText||n,c),a=!0)}}c.open(u,n.url,!0);var p=c.onload=l(200);c.onreadystatechange=function(){4===c.readyState&&p()},c.onerror=l(null,"Error"),c.ontimeout=l(null,"Timeout"),c.onabort=l(null,"Abort"),s&&(o(i,"X-Requested-With","XMLHttpRequest"),e.FormData&&s instanceof e.FormData||o(i,"Content-Type","application/x-www-form-urlencoded"));for(var f=0,d=t.length;f<d;f++)void 0!==n[v=t[f]]&&(c[v]=n[v]);for(var v in i)c.setRequestHeader(v,i[v]);return c.send(s),c}}).call(this,t(8))},function(e,n,t){var o=t(0),r=t(4),i=t(6),s=t(7),u=t(9),a=t(10),c={port:function(){return""===location.port||"80"===location.port?"":":"+location.port},path:function(){var e=location.pathname,n=e.substring(0,e.lastIndexOf("/")+1);return 0===n.length&&(n="/"),n},ws:()=>("https:"===location.protocol?"wss://":"ws://")+location.hostname+c.port()+c.path()+"api",log:function(){return location.protocol+"//"+location.hostname+c.port()+c.path()+"log"},pooling:function(){return location.protocol+"//"+location.hostname+c.port()+c.path()+"pooling"},forcePooling:function(){return location.search.search("forcePooling")>-1}};e.exports=function(e){var n=r(v),t=s(c.log()),l=i(),p={current:void 0,previous:void 0,ws:void 0,pooling:void 0,onChange:function(){},ready:()=>!!p.current,name:function(e){return e===p.ws?"ws":e===p.pooling?"pooling":"none"},send:function(e,n){(p.current||p.pooling).send(e,n)}},f={default:function(e){console.error(e)},ignore:function(e){}};function d(e,n){n=n||f.default,p.send(e,n)}function v(e){p.ready()&&d(e=e||n.message(),f.ignore)}function g(e){if(!e)return!1;for(var t=o.unpack(e),r=!1,i=0;i<t.length;i++){var s=t[i];if(null===s)return r;switch(s.type){case o.messageType.publish:n.publish(s);break;case o.messageType.response:l.response(s);break;case o.messageType.alive:break;case o.messageType.ping:d(o.pong(),f.ignore);break;case o.messageType.pong:r=!0}}return r}return p.onChange=function(n){if(e)try{e(n)}catch(e){console.error(e)}},p.pooling=a(c.pooling(),g,n.message),c.forcePooling()?p.current=p.pooling:p.ws=u(c.ws(),g,function(e){p.previous=p.current,p.current=e.success?p.ws:p.pooling,(p.current===p.ws&&e.connected||p.current===p.pooling)&&v(),p.previous===p.pooling&&p.current===p.ws&&p.pooling.stop(),e.connected?t.info(e):t.error(e),p.onChange({transport:p.name(p.current),previousTransport:p.name(p.previous),status:e})}),{request:function(e,n,t,o){t=t||function(){},o=o||f.default,d(l.request(e,n,t,o),o)},subscribe:n.add,unSubscribe:n.remove}}},function(e,n,t){var o=t(0),r=t(5);e.exports=function(e){var n={};function t(){var e={};for(var t in n)e[t]=n[t].ts;return{type:o.messageType.subscribe,subscriptions:e}}function i(){null!=e&&e(t())}return{add:function(e,t){var o=n[e];void 0===o?(o={key:e,ts:0,handlers:[],full:null,diff:null},n[e]=o,i()):t(o.full,null),o.handlers.push(t)},remove:function(e,t){var o=n[e];if(void 0!==o){var r=o.handlers.indexOf(t);r>-1&&o.handlers.splice(r,1),0===o.handlers.length&&(delete n[e],i())}},publish:function(e){var t=e.uri,i=n[t];if(i){if(e.updateType===o.updateType.close)return delete n[t],void i.handlers.forEach(function(e){e(null,null)});i.ts=e.ts,e.updateType!==o.updateType.full&&e.updateType!==o.updateType.append&&e.updateType!==o.updateType.update||(i.full=e.body,i.diff=null),e.updateType===o.updateType.diff&&(i.full||(i.full={}),i.diff=e.body,r(i.full,e.body)),i.handlers.forEach(function(e){e(i.full,i.diff)})}else console.log("topic not found",t)},message:t}}},function(e,n){function t(e){if(void 0!==e._list)return e._list;var n=[];for(var t in e){var o=e[t];"object"==typeof o&&0!==t.indexOf("_")&&n.push(o)}return n.sort(function(e,n){return void 0===e.order&&(e.order=0),void 0===n.order&&(n.order=0),e.order!==n.order?e.order-n.order:e.name>n.name?1:e.name<n.name?-1:0}),e._list=n,n}e.exports=function(e,n){!function e(n,t){for(var o in t){var r=t[o];if(null!=r)if("object"!=typeof r){var i=n[o];n[o]=r,void 0!==i&&r!==i&&(n["_"+o+"Change"]={previous:i,changedAt:(new Date).getTime()})}else{void 0===n[o]&&(n[o]={});var s=n._collection;r._isStruct&&(s=n);var u=n[o];u._collection=n,u._parent=s,u._key=o,delete u._list,e(u,r)}else delete n[o],delete n["_"+o+"Change"]}}(e,n),function e(n){for(var o in n){var r=n[o];if("object"==typeof r&&0!==o.indexOf("_")){if(!0===r._isMap){var i=r;n[o+"List"]=function(){return t(i)}}e(r)}}}(e)}},function(e,n,t){var o=t(0),r=t(1);e.exports=function(){var e=0,n={};return{request:function(t,r,i,s){e++;var u={type:o.messageType.request,uri:t,correlationID:e,body:r};return n[e]={ok:i,fail:s},u},response:function(e){var t=n[e.correlationID];delete n[e.correlationID],e.error?t.fail(r.server(e)):t.ok(e.body)}}}},function(e,n,t){var o=t(2);function r(e,n,t,r){o.ajax({url:e,method:"POST",body:JSON.stringify(n)},function(e,n){e>=200&&e<300||console.error(e,n)})}e.exports=function(e){return{info:function(n){r(e+"/info",n)},error:function(n){r(e+"/error",n)}}}},function(e,n){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(e,n,t){var o=t(0),r=t(1);function i(){return(new Date).getTime()}e.exports=function(e,n,t){function s(e){try{t(e)}catch(e){console.log(e)}}var u=null,a={timer:void 0,schedule:function(e){a.timer=setTimeout(e,16e3)},clear:function(){clearTimeout(a.timer)},onMessage:function(e){e&&a.clear()},start:function(){a.schedule(function(){u.readyState==WebSocket.OPEN&&(l.event("pongTimeout"),u.close())})}},c={timer:void 0,no:0,lastMessage:0,afterPongInterval:16e3,beforePongInterval:4e3,interval:4e3,clear:function(){clearTimeout(c.timer)},start:function(){c.interval=c.beforePongInterval,c.lastMessage=0,c.loop()},loop:function(){i()-c.lastMessage>c.interval/2&&(c.no++,p(o.ping(c.no),function(e){l.event("pingError",e)})),c.timer=setTimeout(c.loop,c.interval)},onMessage:function(e){c.lastMessage=i(),e&&(c.interval=c.afterPongInterval)}},l={success:!1,opened:!1,fallback:!1,giveup:!1,connected:!1,supported:!1,start:i(),startConnect:i(),messages:0,connects:0,retries:0,events:[],onMessage:function(e){l.messages++,e&&!l.connected&&(l.event("pong"),l.success=!0,l.connected=!0,l.retries=l.connects,l.change())},event:function(e,n){var t={name:e,sinceStart:i()-l.start,sinceConnect:i()-l.startConnect};n&&(n.code&&(t.code=n.code),n.type&&(t.type=n.type),n.reason&&(t.reason=n.reason),n.message&&(t.message=n.message),n.name&&(t.name=n.name),t.error=n.toString()),l.events.push(t)},change:function(){s(l)},shouldQuit:function(){return l.connects++,l.startConnect=i(),!l.success&&(l.connects>32?(l.giveup=!0,l.change(),!0):(5===l.connects&&(l.fallback=!0,l.change()),!1))},connectInterval:function(){var e=l.connects||1;return e>12&&(e=12),Math.pow(2,e)}};function p(e,n){function t(e,t,o){n(r.ws(t)),l.event("sendError"+e,o)}if(u)if(u.readyState===WebSocket.OPEN){var i=o.pack(e);try{u.send(i)}catch(e){t(3,e.toString(),e)}}else t(2,"connection closed readyState: "+u.readyState);else t(1,"connection uninitialized")}if(l.supported="WebSocket"in window&&null!=window.WebSocket,l.supported)return function t(){if(!l.shouldQuit()){try{u=new WebSocket(e)}catch(e){return o(),void l.event("wsError",e)}u.onopen=function(){l.opened=!0,a.start(),c.start(),l.event("open")},u.onclose=function(e){o(),l.event("close",e)},u.onmessage=function(e){var t=function(e){try{return n(e)}catch(e){console.log(e)}return!1}(e.data);l.onMessage(t),c.onMessage(t),a.onMessage(t)}}function o(){a.clear(),c.clear(),setTimeout(t,l.connectInterval()),l.connected=!1}}(),{send:p};s()}},function(e,n,t){var o=t(0),r=t(1),i=t(2);e.exports=function(e,n,t){var s={},u=!1;function a(n,t,s){var u=o.pack(n);i.ajax({url:e,method:"POST",body:u},function(e,n){e>=200&&e<300?t(n):s(r.pooling(e,n))})}return{send:function(e,r){e.type!=o.messageType.subscribe?a(e,n,r):function e(r){for(var i in r.subscriptions)if(void 0===s[i]){var c=r.subscriptions[i];s[i]=c;var l={type:o.messageType.subscribe,subscriptions:{}};l.subscriptions[i]=c,a(l,function(o){delete s[i],o&&n(o),u||e(t())},function(n,o){delete s[i],n>=400&&n<500||(console.error(n,o),u||setTimeout(function(){e(t())},4e3))})}}(e)},stop:function(){u=!0}}}}]);